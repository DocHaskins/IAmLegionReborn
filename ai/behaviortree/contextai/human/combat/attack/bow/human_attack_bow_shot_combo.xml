<?xml version="1.0"?>
<BehaviorTree xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../../../../../MetaData/schema_ai.xsd" m_ContextType="ai">
    <SequenceMem>
        <Opr_SetBBValue_int m_Key="#arrows" m_Value="$bow_shot_combo_count"/>
        <Parallel m_PolicySuccess="REQUIRE_ONE" m_PolicyFailure="REQUIRE_ONE">
            <Act_WeaponAim m_Type="Fast" m_Target="#target" m_HitPredictionFactor="$bow_aim_prediction_factor" m_CustomBulletSpeed="$bow_arrow_speed" m_StartPolicy="INTERRUPT" m_AbandonPolicy="BLENDOUT"/>
            <Act_Idle m_Type="Stand" m_StartPolicy="INTERRUPT" m_AbandonPolicy="BLENDOUT"/>
            <RepeatOnceOnSuccess>
                <SelectorMem>
                    <Cnd_IsBBValueGreater_int m_Key="#arrows" m_Value="0" m_Invert="true"/>
                    <SequenceMem>
                        <SelectorMem>
                            <Cnd_IsPrimaryWeaponReloaded/>
                            <Act_WeaponReload m_StartPolicy="INTERRUPT" m_AbandonPolicy="INTERRUPT" m_DecisionPolicy="WHEN_POSSIBLE"/>
                        </SelectorMem>
                        <RunUntilSuccess>
                            <Cnd_IsWeaponAimSteady/>
                        </RunUntilSuccess>
                        <SelectorMem>
                            <SequenceMem>
                                <Cnd_IsBBValueEqual_int m_Key="#arrows" m_Value="$bow_shot_combo_count"/>
                                <Act_WaitTimeDelta m_TimeToWait="$bow_aim_delay"/>
                            </SequenceMem>
                            <Act_WaitTimeDelta m_TimeToWait="$bow_shot_combo_delay"/>
                        </SelectorMem>
                        <Cnd_AllyInLineOfFire m_Target="#target" m_SpaceNeeded="0.5" m_Invert="true"/>
                        <Opr_DecrementBBValue_int m_Key="#arrows" m_Amount="1"/>
                        <Opr_RequestBarkTarget m_Player="combat_range_warning" m_Priority="Instant"/>
                        <Act_WeaponShoot m_Target="#target" m_HitPredictionFactor="$bow_hit_prediction_factor" m_CustomBulletSpeed="$bow_arrow_speed" m_AutoCorrectionAngle="$bow_arrow_correction_angle" m_StartPolicy="INTERRUPT" m_AbandonPolicy="INTERRUPT" m_DecisionPolicy="WHEN_POSSIBLE"/>
                    </SequenceMem>
					<Optional m_Enabled="$enable_attack_step_back">
            <SelectorMem>
                <Cnd_IsCombatTargetInRadius m_Radius="$attack_quick_step_escape_max_range" m_Invert="true"/>
                <Cnd_SpaceInSimpleDirection m_Direction="BACKWARD" m_Invert="true" m_MinRequiredSpace="$enviro_space_required" m_CheckHalfAngle="$enviro_space_half_angle"/>
                <SequenceMem>
                    <Opr_SetDirCorrectionSpeed m_MaxSpeed="$step_dir_correction_speed"/>
                    <Act_Step m_Direction="BACKWARD" m_Type="ESCAPE" m_Style="Aggressive" m_Target="#target" m_StartPolicy="INTERRUPT" m_AbandonPolicy="INTERRUPT" m_DecisionPolicy="WHEN_POSSIBLE"/>
                </SequenceMem>
            </SelectorMem>
        </Optional>
                </SelectorMem>
            </RepeatOnceOnSuccess>
        </Parallel>
    </SequenceMem>
</BehaviorTree>
