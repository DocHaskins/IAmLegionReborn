<?xml version="1.0"?>
<BehaviorTree xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../../../../../MetaData/schema_ai.xsd" m_ContextType="ai">
    <SequenceMem>
        <Opr_SetDirCorrectionSpeed m_MaxSpeed="$attack_spear_power_dir_correction_speed"/>
        <Opr_SetPosCorrectionSpeed m_MaxSpeed="$attack_pos_correction_speed"/>
        <Opr_SetBBValue_bool m_Key="#trigger_power_followup" m_Value="false"/>
        <Opr_SetBBValue_bool m_Key="#trigger_power_fail" m_Value="false"/>
        <Parallel m_PolicySuccess="REQUIRE_ONE" m_PolicyFailure="REQUIRE_ONE">
            <Act_Attack m_Target="#target" m_AttackPresetName="human_spear_power_combo" m_Phase="0" m_EnablePosCorrection="$enable_attack_pos_correction" m_StartPolicy="DISCARD" m_AbandonPolicy="BLENDOUT" m_DecisionPolicy="ON_END"/>
            <Selector>
                <Trigger m_Key="#trigger_power_followup">
                    <RunUntilSuccess>
                        <Sequence>
                            <Cnd_CanAttackCombo/>
                            <Cnd_IsCombatTargetInRadius m_Radius="$attack_spear_power_followup_max_range" m_UsePrediction="true"/>
                        </Sequence>
                    </RunUntilSuccess>
                </Trigger>
                <Trigger m_Key="#trigger_power_fail">
                    <RunUntilSuccess>
                        <Selector>
                            <DelayerTimeDelta m_DelayTime="0.2">
                                <Cnd_SpaceInSimpleDirection m_Direction="FORWARD" m_CheckHalfAngle="10" m_MinRequiredSpace="1" m_Invert="true"/>
                            </DelayerTimeDelta>
                            <Cnd_IsCombatTargetInAngle m_Angle="120" m_Invert="true"/>
                            <Cnd_IsCombatTargetInRadius m_Radius="2"/>
                        </Selector>
                    </RunUntilSuccess>
                </Trigger>
            </Selector>
            <Runner>
                <Sequence>
                    <Cnd_TargetIsDodging m_Target="#target"/>
                    <Opr_SetDirCorrectionSpeed m_MaxSpeed="0"/>
                </Sequence>
            </Runner>
        </Parallel>
        <Opr_SetDirCorrectionSpeed m_MaxSpeed="0"/>
        <Succeeder>
            <Starter m_Key="#trigger_power_followup">
                <Act_Attack m_Target="#target" m_AttackPresetName="human_spear_power_combo" m_Phase="1" m_EnablePosCorrection="$enable_attack_pos_correction" m_StartPolicy="DISCARD" m_AbandonPolicy="INTERRUPT" m_DecisionPolicy="WHEN_POSSIBLE"/>
            </Starter>
        </Succeeder>
        <Succeeder>
            <Starter m_Key="#trigger_power_fail">
                <Act_Attack m_Target="#target" m_AttackPresetName="human_spear_power_combo" m_Phase="2" m_EnablePosCorrection="$enable_attack_pos_correction" m_StartPolicy="DISCARD" m_AbandonPolicy="INTERRUPT" m_DecisionPolicy="WHEN_POSSIBLE"/>
            </Starter>
        </Succeeder>
    </SequenceMem>
</BehaviorTree>
