<?xml version="1.0"?>
<BehaviorTree xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../../../../MetaData/schema_ai.xsd" m_ContextType="ai">
    <Sequence>
        <Selector>
            <Cnd_IsRestrictedAreaRequired m_Invert="true"/>
            <Cnd_TargetInRestrictedArea/>
        </Selector>
        <Cnd_HasPathToCombatTarget/>
        <Selector>
            <SequenceMem>
                <Cnd_IsCombatTargetInRadius m_Radius="$combat_idle_strafe_min" m_Invert="true"/>
                <Selector>
                    <Cnd_HasStrafePathToCombatTarget m_Invert="true"/>
                    <Cnd_IsCombatTargetInRadius m_Radius="$combat_loco_start" m_Invert="true"/>
                </Selector>
                <Sequence>
                    <Selector>
                        <!-- TODO distance hysteresis -->
                        <Cnd_IsCombatTargetInRadius m_Radius="$combat_idle_strafe_min"/>
                        <Cnd_HasStrafePathToCombatTarget m_Invert="true"/>
                        <Cnd_IsCombatTargetInRadius m_Radius="$combat_loco_end" m_Invert="true"/>
                    </Selector>
                    <Act_Move m_Destination="#target_pos" m_MoveStyle="#move_style_walk" m_StopAtDest="false" m_TryToFindDestinationOnNavmesh="true" m_IsAvoidanceActive="$use_avoidance" m_StartPolicy="INTERRUPT" m_AbandonPolicy="BLENDOUT" m_DecisionPolicy="ON_END"/>
                </Sequence>
            </SequenceMem>
            <SequenceMem>
                <ExternalTree m_UID="HUMAN_COMBAT_STRAFE_TURN" m_CustomName="StrafeTurn" m_Hide="true"/>
                <Act_Strafe m_Target="#target" m_Logic="KEEP_DISTANCE" m_MinDistance="$combat_idle_strafe_min" m_MaxDistance="$combat_idle_strafe_max" m_FacingAngle="10" m_Speed="0.5" m_SpringUpdateSpeed="$strafe_spring_update_speed" m_Style="Aggressive" m_StartPolicy="INTERRUPT" m_AbandonPolicy="BLENDOUT" m_DecisionPolicy="ON_END"/>
            </SequenceMem>
        </Selector>
    </Sequence>
</BehaviorTree>
