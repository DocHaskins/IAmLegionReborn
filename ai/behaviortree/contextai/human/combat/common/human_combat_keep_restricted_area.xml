<?xml version="1.0"?>
<BehaviorTree xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../../../../MetaData/schema_ai.xsd" m_ContextType="ai">
    <Sequence>
        <Cnd_IsRestrictedAreaRequired/>
        <SequenceMem>
            <Opr_GetRestrictedAreaRetreatPosition m_Position="#restricted_area_retreat_position"/>
            <!-- go back inside -->
            <Selector>
                <Cnd_SelfInRestrictedArea/>
                <SelectorMem>
                    <Act_StrafeToDestination m_Target="#target" m_Destination="#restricted_area_retreat_position" m_Style="Aggressive" m_FailIfDestUnreachable="true" m_Speed="2" m_SpringUpdateSpeed="$strafe_spring_update_speed" m_EndRadius="$strafe_end_radius" m_StartPolicy="INTERRUPT" m_AbandonPolicy="BLENDOUT" m_DecisionPolicy="ON_END"/>
                    <Act_Move m_Destination="#restricted_area_retreat_position" m_MoveStyle="#move_style_trot" m_StopAtDest="true" m_IsAvoidanceActive="$use_avoidance" m_StartPolicy="INTERRUPT" m_AbandonPolicy="BLENDOUT" m_DecisionPolicy="ON_END"/>
                </SelectorMem>
            </Sequence>
            <!-- try to keep distance to combat target -->
            <Cnd_IsCombatTargetInRadius m_Radius="4"/>
            <Sequence>
                <Cnd_IsCombatTargetInRadius m_Radius="5"/>
                <Cnd_PositionInRadius m_Radius="2" m_Position="#restricted_area_retreat_position" m_Invert="true"/>
                <SelectorMem>
                    <Act_StrafeToDestination m_Target="#target" m_Destination="#restricted_area_retreat_position" m_Style="Aggressive" m_FailIfDestUnreachable="true" m_Speed="2" m_SpringUpdateSpeed="$strafe_spring_update_speed" m_EndRadius="$strafe_end_radius" m_StartPolicy="INTERRUPT" m_AbandonPolicy="BLENDOUT" m_DecisionPolicy="ON_END"/>
                    <Act_Move m_Destination="#restricted_area_retreat_position" m_MoveStyle="#move_style_trot" m_StopAtDest="true" m_IsAvoidanceActive="$use_avoidance" m_StartPolicy="INTERRUPT" m_AbandonPolicy="BLENDOUT" m_DecisionPolicy="ON_END"/>
                </SelectorMem>
            </Sequence>
        </SequenceMem>
    </Sequence>
</BehaviorTree>
