<?xml version="1.0" encoding="UTF-8"?>
<BehaviorTree xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../../../MetaData/schema_ai.xsd" m_ContextType="ai">
    <SequenceMem>
        <Cnd_HasThrowableMolotovInInventory/>
        <Selector>
            <!-- drink and spit -->
            <CooldownTimeDelta m_CooldownTime="$attack_molotov_spit_cooldown" m_CooldownOnAbort="true">
                <SequenceMem>
                    <Cnd_HasActiveWeaponSpecific m_Type="Molotov"/>
                    <Cnd_HasPathToCombatTarget/>
                    <Selector>
                        <Cnd_IsRestrictedAreaRequired m_Invert="true"/>
                        <Cnd_SelfInRestrictedArea/>
                    </Selector>
                    <ExternalTree m_UID="HUMAN_ATTACK_MOLOTOV_DRINK"/>
                    <SelectorMem>
                        <SequenceMem>
                            <Selector>
                                <ExternalTree m_UID="HUMAN_ATTACK_MOLOTOV_SPIT"/>
                                <TimeDeltaLimit m_TimeMax="$attack_molotov_spit_flush_min_time">
                                    <SelectorMem>
                                        <SequenceMem>
                                            <SelectorMem>
                                                <Cnd_IsCombatTargetInAngle m_Angle="30"/>
                                                <Act_TurnToPos m_Position="#target_pos" m_Type="Combat" m_StartPolicy="INTERRUPT" m_AbandonPolicy="BLENDOUT" m_DecisionPolicy="ON_END"/>
                                            </SelectorMem>
                                            <Act_StrafeToDestination m_Target="#target" m_Destination="#target_pos" m_FailIfDestUnreachable="true" m_Speed="2" m_SpringUpdateSpeed="$strafe_spring_update_speed" m_EndRadius="$strafe_end_radius" m_Style="Aggressive" m_StartPolicy="INTERRUPT" m_AbandonPolicy="BLENDOUT" m_DecisionPolicy="ON_END"/>
                                        </SequenceMem>
                                        <Act_Move m_Destination="#target_pos" m_MoveStyle="#move_style_walk_combat" m_StopAtDest="false" m_PosToKeepDistanceFrom="#target_pos" m_KeepDistanceRadius="3" m_TryToFindDestinationOnNavmesh="true" m_IsAvoidanceActive="$use_avoidance" m_StartPolicy="INTERRUPT" m_AbandonPolicy="BLENDOUT" m_DecisionPolicy="ON_END"/>
                                    </SelectorMem>
                                </TimeDeltaLimit>
                            </Selector>
                            <SelectorMem>
                                <Cnd_IsCombatTargetInRadius m_Radius="6" m_Invert="true"/>
                                <Cnd_SpaceInSimpleDirection m_Direction="BACKWARD" m_MinRequiredSpace="$enviro_space_required" m_CheckHalfAngle="$enviro_space_half_angle" m_Invert="true"/>
                                <Act_Dodge m_Target="#target" m_Type="EVADE" m_Direction="BACKWARD" m_StartPolicy="INTERRUPT" m_AbandonPolicy="INTERRUPT" m_DecisionPolicy="WHEN_POSSIBLE"/>
                            </SelectorMem>
                        </SequenceMem>
                        <SequenceMem>
                            <Cnd_IsCombatTargetMeleeReachable/>
                            <ExternalTree m_UID="HUMAN_ATTACK_MOLOTOV_FLUSH"/>
                        </SequenceMem>
                    </SelectorMem>
                </SequenceMem>
            </CooldownTimeDelta>
            <!-- throw molotov -->
            <ExternalTree m_UID="HUMAN_COMBAT_THROW_MOLOTOV"/>
            <!-- molotov taunt -->
            <CooldownTimeDelta m_CooldownTime="$attack_molotov_taunt_cooldown" m_CooldownOnAbort="true">
                <SequenceMem>
                    <Cnd_HasActiveWeaponSpecific m_Type="Molotov"/>
                    <Cnd_IsCombatTargetInRadius m_Radius="12" m_Invert="true"/>
                    <Act_Attack m_Target="#target" m_AttackPresetName="human_molotov_spit" m_Phase="0" m_EnablePosCorrection="$enable_attack_pos_correction" m_StartPolicy="INTERRUPT" m_AbandonPolicy="INTERRUPT" m_DecisionPolicy="WHEN_POSSIBLE"/>
                    <Act_Attack m_Target="#target" m_AttackPresetName="human_molotov_spit" m_Phase="2" m_EnablePosCorrection="$enable_attack_pos_correction" m_StartPolicy="INTERRUPT" m_AbandonPolicy="INTERRUPT" m_DecisionPolicy="WHEN_POSSIBLE"/>
                </SequenceMem>
            </CooldownTimeDelta>
            <!-- position -->
            <ExternalTree m_UID="HUMAN_COMBAT_POSITION_GRENADIER" m_CustomName="Position" m_Hide="true"/>
        </Selector>
    </SequenceMem>
</BehaviorTree>
