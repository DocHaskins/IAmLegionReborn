<?xml version="1.0"?>
<BehaviorTree xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../../../../MetaData/schema_ai.xsd" m_ContextType="ai">
    <SequenceMem>
        <Cnd_CanStartTask m_StartPolicy="DISCARD"/>
        <Cnd_CanInterruptActivityModule_Movement/>
        <Cnd_CanInterruptActivityModule_Attack/>
        <Cnd_IsCombatTargetInLOS/>
        <Cnd_HasActiveWeapon m_WeaponType="OneHandedMelee"/>
        <Cnd_IsCombatTargetInRange m_Radius="8" m_Angle="90"/>
        <Cnd_InTargetHorzAngle m_Target="#target" m_Angle="30"/>
        <SelectorMem>
            <CooldownTimeDelta m_CooldownTime="1" m_CooldownOnAbort="true">
                <SequenceMem>
                    <Cnd_IsPlayer m_Target="#target"/>
                    <Cnd_InTargetFallImpact m_Target="#target" m_MinDistance="2" m_MaxDistance="5"/>
                    <Cnd_IsTargetApproaching m_Target="#target" m_MinVel="1" m_MaxAngle="45"/>
                    <Act_Reaction m_Type="STARTLE" m_Direction="BACKWARD" m_StartPolicy="DISCARD" m_AbandonPolicy="INTERRUPT" m_DecisionPolicy="WHEN_POSSIBLE"/>
                </SequenceMem>
            </CooldownTimeDelta>
            <CooldownTimeDelta m_CooldownTime="1" m_CooldownOnAbort="true">
                <SequenceMem>
                    <Cnd_IsTargetAttacking m_Target="#target"/>
                    <Cnd_IsTargetAttackWindingUp m_Target="#target"/>
                    <SelectorMem>
                        <!-- before hit reactions temporarily disabled -->
                        <Optional m_Enabled="false">
                            <SequenceMem>
                                <Cnd_InTargetAttackRange m_Target="#target"/>
                                <Opr_EvaluateAttackReactionDirection m_Target="#target" m_Direction="#attack_reaction_dir"/>
                                <Opr_SetDirCorrectionSpeed m_MaxSpeed="180"/>
                                <Act_Reaction m_Type="BEFORE_HIT" m_Direction="#attack_reaction_dir" m_Target="#target" m_StartPolicy="DISCARD" m_AbandonPolicy="INTERRUPT" m_DecisionPolicy="WHEN_POSSIBLE"/>
                            </SequenceMem>
                        </Optional>
                        <SequenceMem>
                            <Cnd_InTargetAttackRange m_Target="#target" m_Invert="true"/>
                            <Opr_SetDirCorrectionSpeed m_MaxSpeed="180"/>
                            <Act_Reaction m_Type="FLINCH" m_Target="#target" m_StartPolicy="DISCARD" m_AbandonPolicy="INTERRUPT" m_DecisionPolicy="WHEN_POSSIBLE"/>
                        </SequenceMem>
                    </SelectorMem>
                </SequenceMem>
            </CooldownTimeDelta>
        </SelectorMem>
    </SequenceMem>
</BehaviorTree>
