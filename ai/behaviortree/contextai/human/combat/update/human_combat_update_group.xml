<?xml version="1.0"?>
<BehaviorTree xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../../../../MetaData/schema_ai.xsd" m_ContextType="ai">
    <Succeeder>
        <Sequence>
            <Opr_SetBBValue_string m_Key="#role" m_Value="none"/>
            <Opr_EvaluateDistanceCost m_Position="#target_pos" m_Cost="#role_cost"/>
            <Selector>
                <Cnd_HasBBValue m_Key="#target" m_Invert="true"/>
                <Sequence>
                    <Cnd_HasPathToCombatTarget m_Invert="true"/>
                    <Cnd_IsCombatTargetMeleeReachable m_Invert="true"/>
                </Sequence>
                <Sequence>
                    <Cnd_IsRestrictedAreaRequired/>
                    <Cnd_TargetInRestrictedArea m_Invert="true"/>
                </Sequence>
                <Sequence>
                    <Selector>
                        <Cnd_HasWeaponInInventory m_WeaponType="TwoHandedMelee"/>
                        <Cnd_HasWeaponInInventory m_WeaponType="ShortSpear"/>
                    </Selector>
                    <Opr_RequestCombatSlot m_Name="melee" m_Limit="$combat_slot_melee_limit" m_MinDelay="$combat_slot_melee_min_delay" m_MaxKeepTime="$combat_slot_melee_max_keep_time" m_Cost="#role_cost"/>
                    <Opr_SetBBValue_string m_Key="#role" m_Value="melee"/>
                </Sequence>
                <Sequence>
                    <Cnd_HasBBValue m_Key="#range_pos" m_Invert="true"/>
                    <Selector>
                        <Cnd_IsBBValueEqual_string m_Key="#tactic" m_Value="rush"/>
                        <Opr_RequestCombatSlot m_Name="melee" m_Limit="$combat_slot_melee_limit" m_MinDelay="$combat_slot_melee_min_delay" m_MaxKeepTime="$combat_slot_melee_max_keep_time" m_Cost="#role_cost"/>
                    </Selector>
                    <Opr_SetBBValue_string m_Key="#role" m_Value="melee"/>
                </Sequence>
                <Optional m_Enabled="$combat_slot_idle_enabled">
                    <Opr_RequestCombatSlot m_Name="idle" m_Limit="$combat_slot_idle_limit" m_MinDelay="$combat_slot_idle_min_delay" m_MaxKeepTime="$combat_slot_idle_max_keep_time" m_Cost="#role_cost"/>
                </Optional>
            </Selector>
            <Optional m_Enabled="$enable_debug">
                <Opr_DebugPrintValue_string m_Label="Role" m_Value="#role" m_Height="0.25"/>
            </Optional>
        </Sequence>
    </Succeeder>
</BehaviorTree>
