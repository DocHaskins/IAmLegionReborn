<?xml version="1.0" encoding="UTF-8"?>
<BehaviorTree xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../../../../MetaData/schema_ai.xsd" m_ContextType="ai">
    <SequenceMem>
        <Cnd_IsCombatTargetMeleeReachable/>
        <Cnd_IsCombatTargetInLOS/>
        <Cnd_IsCombatTargetInAngle m_Angle="$attack_quick_max_angle"/>
        <Cnd_IsHeightDiffToTargetGreater m_Target="#target" m_HeightDiff="1.0" m_Invert="true"/>
        <Cnd_CanInterruptActivityModule_Taunt/>
        <Cnd_CanStartTask m_StartPolicy="INTERRUPT"/>
        <Selector>
            <Sequence>
                <Cnd_IsActivityModuleRunning_Movement/>
                <Cnd_IsCombatTargetInRadius m_Radius="$attack_from_move_max_range" m_UsePrediction="true"/>
            </Sequence>
            <Cnd_IsCombatTargetInRadius m_Radius="$attack_quick_max_range"/>
        </Selector>
        <Opr_SetDirCorrectionSpeed m_MaxSpeed="$attack_quick_dir_correction_speed"/>
        <Opr_RandomInt m_RangeMin="$attacks_in_combo_min" m_RangeMax="$attacks_in_combo_max" m_Result="#combo_attacks" />
        <Opr_DecrementBBValue_int m_Key="#combo_attacks" m_Amount="1"/>
        <Opr_Trigger m_Key="#trigger_combo"/>
        <Succeeder>
            <RepeatOnceOnSuccess>
                <Starter m_Key="#trigger_combo">
                    <Parallel m_PolicySuccess="REQUIRE_ONE" m_PolicyFailure="REQUIRE_ONE">
                        <SelectorMem>
                            <SequenceMem>
                                <Cnd_IsBBValueEqual_int m_Key="#combo_attacks" m_Value="0"/>
                                <Act_Attack m_Target="#target" m_AttackPresetName="volatile_combo_end" m_StartPolicy="INTERRUPT" m_AbandonPolicy="INTERRUPT" m_DecisionPolicy="ON_INTERRUPT"/>
                            </SequenceMem>
                            <Act_Attack m_Target="#target" m_AttackPresetName="volatile_light_attack" m_StartPolicy="INTERRUPT" m_AbandonPolicy="INTERRUPT" m_DecisionPolicy="WHEN_POSSIBLE"/>
                        </SelectorMem>
                        <RunUntilSuccess>
                            <Selector>
                                <Sequence>
                                    <Cnd_IsBBValueGreater_int m_Key="#combo_attacks" m_Value="0"/>
                                    <Cnd_CanInterruptActivityModule_Attack/>
                                    <Cnd_IsCombatTargetMeleeReachable/>
                                    <Cnd_IsCombatTargetInLOS/>
                                    <Cnd_IsCombatTargetInRadius m_Radius="$attack_quick_max_range" m_UsePrediction="true"/>
                                    <Opr_DecrementBBValue_int m_Key="#combo_attacks" m_Amount="1"/>
                                    <Opr_Trigger m_Key="#trigger_combo"/>
                                </Sequence>
                            </Selector>
                        </RunUntilSuccess>
                    </Parallel>
                </Starter>
            </RepeatOnceOnSuccess>
        </Succeeder>
    </SequenceMem>
</BehaviorTree>
